<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-cover bg-center h-screen flex justify-center items-center" style="background-image: url('assets/bg.jpg');">
    <div class="w-96 p-6 bg-white/20 backdrop-blur-md rounded-lg text-white shadow-lg">
        <header class="flex gap-2 mb-6">
            <input type="text" id="city-input" placeholder="Search City" class="flex-grow p-2 bg-white/20 rounded-lg outline-none text-black">
            <button id="search-btn" class="bg-blue-500 p-2 rounded-lg">
                <span class="material-symbols-outlined">search</span>
            </button>
        </header>

        <section class="text-center">
            <div class="flex justify-between items-center mb-4">
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined">location_on</span>
                    <h4 id="city-name" class="font-semibold">Jakarta</h4>
                </div>
                <h5 id="current-date" class="text-sm">Wed, 07 Aug</h5>
            </div>

            <div class="flex flex-col items-center mb-4">
                <img id="weather-icon" src="assets/weather/clouds.svg" alt="Weather Icon" class="w-24">
                <h1 id="temperature" class="text-4xl font-bold">29°C</h1>
                <h3 id="weather-condition" class="text-lg">Clouds</h3>
            </div>

            <div class="flex justify-around text-sm">
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined">water_drop</span>
                    <div>
                        <h5>Humidity</h5>
                        <h5 id="humidity">55%</h5>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined">air</span>
                    <div>
                        <h5>Wind Speed</h5>
                        <h5 id="wind-speed">2 m/s</h5>
                    </div>
                </div>
            </div>
        </section>

        <section class="mt-6">
            <h3 class="text-lg font-semibold mb-2">5-Day Forecast</h3>
            <div id="forecast-container" class="flex overflow-x-auto space-x-4 p-2 scrollbar-thin scrollbar-thumb-gray-400"></div>
        </section>
    </div>

    <script>
        const apiKey = "9a2eadbfa7fc0dff84bbffb58b7c3410";

        document.getElementById("search-btn").addEventListener("click", () => {
            const city = document.getElementById("city-input").value.trim();
            if (city) {
                updateWeatherInfo(city);
                document.getElementById("city-input").value = "";
            }
        });

        document.getElementById("city-input").addEventListener("keydown", (event) => {
            if (event.key.toLowerCase() === "enter") {
                const city = document.getElementById("city-input").value.trim();
                if (city) {
                    updateWeatherInfo(city);
                    document.getElementById("city-input").value = "";
                }
            }
        });

        async function fetchWeatherData(city) {
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`;
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error("City not found");
                return await response.json();
            } catch (error) {
                console.error(error);
                alert("City not found. Please try again.");
            }
        }

        async function fetchForecastData(city) {
            const url = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric`;
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error("City not found");
                return await response.json();
            } catch (error) {
                console.error(error);
            }
        }

        async function updateWeatherInfo(city) {
            const data = await fetchWeatherData(city);
            if (!data) return;

            document.getElementById("city-name").textContent = data.name;
            document.getElementById("temperature").textContent = `${Math.round(data.main.temp)}°C`;
            document.getElementById("weather-condition").textContent = data.weather[0].main;
            document.getElementById("humidity").textContent = `${data.main.humidity}%`;
            document.getElementById("wind-speed").textContent = `${data.wind.speed} m/s`;
            document.getElementById("weather-icon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;

            updateForecast(city);
        }

        async function updateForecast(city) {
            const data = await fetchForecastData(city);
            if (!data) return;

            const dailyForecast = {};
            data.list.forEach(item => {
                const date = item.dt_txt.split(" ")[0];
                if (!dailyForecast[date]) dailyForecast[date] = item;
            });

            const forecastContainer = document.getElementById("forecast-container");
            forecastContainer.innerHTML = "";

            Object.values(dailyForecast).slice(0, 5).forEach(item => {
                const forecastElement = document.createElement("div");
                forecastElement.className = "bg-white/20 p-4 rounded-lg flex flex-col items-center w-20 text-white";

                const date = document.createElement("p");
                date.textContent = new Date(item.dt_txt).toLocaleDateString("en-US", { weekday: "short" });
                date.className = "text-sm";

                const icon = document.createElement("img");
                icon.src = `https://openweathermap.org/img/wn/${item.weather[0].icon}.png`;
                icon.className = "w-10";

                const temp = document.createElement("p");
                temp.textContent = `${Math.round(item.main.temp)}°C`;
                temp.className = "text-sm";

                forecastElement.appendChild(date);
                forecastElement.appendChild(icon);
                forecastElement.appendChild(temp);

                forecastContainer.appendChild(forecastElement);
            });
        }
    </script>
</body>
</html>
